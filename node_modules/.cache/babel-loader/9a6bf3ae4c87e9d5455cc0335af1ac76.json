{"ast":null,"code":"var _jsxFileName = \"/home/banish/Blogapp-using-MERN/src/App.js\";\nimport React, { useState, useCallback, useEffect } from 'react';\nimport './App.css';\nimport { Route, HashRouter as Router, Switch, Redirect } from 'react-router-dom';\nimport axios from 'axios';\nimport Auth from './Components/Auth/Auth';\nimport MainNavigation from './Containers/Menubar/MainNavigation/MainNavigation';\nimport Posts from './Components/Posts/Posts';\nimport SinglePost from './Components/Posts/SinglePost/SinglePost';\nimport { AuthContext } from './context/auth-context';\nimport CreatePost from './Components/Posts/CreatePost/CreatePost';\nimport Profile from './Components/Users/Profile/Profile';\nimport Mypost from './Components/Posts/Mypost/Mypost';\nimport CreateProfile from './Components/Users/CreateProfile/CreateProfile';\nimport Spinner from './Containers/Spinner/Spinner';\nimport Footer from './Containers/footer/footer';\nimport SocialMedia from './Containers/SocialMedia.js/SocialMedia';\nlet logoutTimer;\n\nconst App = props => {\n  const [token, setToken] = useState(false);\n  const [tokenExpirationDate, setTokenExpirationDate] = useState();\n  const [userId, setUserId] = useState(false);\n  const [isLoading, setIsloading] = useState(true);\n  const login = useCallback((uid, token, expirationDate) => {\n    setToken(token);\n    setUserId(uid);\n    setIsloading(false);\n    const tokenExpirationDate = expirationDate || new Date(new Date().getTime() + 1000 * 60 * 60);\n    setTokenExpirationDate(tokenExpirationDate);\n    localStorage.setItem('userData', JSON.stringify({\n      userId: uid,\n      token: token,\n      expiration: tokenExpirationDate.toISOString()\n    }));\n    axios.defaults.headers.common['Authorization'] = `Bearer ${token}`;\n  }, []);\n  const logout = useCallback(() => {\n    setToken(null);\n    setTokenExpirationDate(null);\n    setUserId(null);\n    localStorage.removeItem('userData');\n    localStorage.removeItem('profileData');\n    let token = null;\n    axios.defaults.headers.common['Authorization'] = `Bearer ${token}`;\n  }, []);\n  useEffect(() => {\n    if (token && tokenExpirationDate) {\n      const remainingTime = tokenExpirationDate.getTime() - new Date().getTime();\n      logoutTimer = setTimeout(logout, remainingTime);\n    } else {\n      clearTimeout(logoutTimer);\n    }\n  }, [token, logout, tokenExpirationDate]);\n  useEffect(() => {\n    const storedData = JSON.parse(localStorage.getItem('userData'));\n    setIsloading(false);\n\n    if (storedData && storedData.token && new Date(storedData.expiration) > new Date()) {\n      login(storedData.userId, storedData.token, new Date(storedData.expiration));\n    }\n  }, [login]);\n  let route;\n  let loading;\n\n  if (isLoading) {\n    loading = /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"container loading\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"mar-20\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(Spinner, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 11\n      }\n    }))));\n  } else {\n    route = /*#__PURE__*/React.createElement(React.Fragment, null, token ? /*#__PURE__*/React.createElement(Route, {\n      path: \"/create\",\n      exact: true,\n      component: CreatePost,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 101,\n        columnNumber: 16\n      }\n    }) : /*#__PURE__*/React.createElement(Redirect, {\n      to: \"/auth\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 101,\n        columnNumber: 78\n      }\n    }), token ? /*#__PURE__*/React.createElement(Route, {\n      path: \"/createProfile\",\n      exact: true,\n      component: CreateProfile,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 102,\n        columnNumber: 16\n      }\n    }) : /*#__PURE__*/React.createElement(Redirect, {\n      to: \"/auth\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 102,\n        columnNumber: 88\n      }\n    }), token ? /*#__PURE__*/React.createElement(Route, {\n      path: \"/edit/:id\",\n      exact: true,\n      component: CreatePost,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 103,\n        columnNumber: 16\n      }\n    }) : /*#__PURE__*/React.createElement(Redirect, {\n      to: \"/auth\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 103,\n        columnNumber: 80\n      }\n    }), token ? /*#__PURE__*/React.createElement(Route, {\n      path: \"/mypost\",\n      exact: true,\n      component: Mypost,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 104,\n        columnNumber: 16\n      }\n    }) : /*#__PURE__*/React.createElement(Redirect, {\n      to: \"/auth\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 104,\n        columnNumber: 74\n      }\n    }), token ? /*#__PURE__*/React.createElement(Route, {\n      path: \"/mypost/:id\",\n      exact: true,\n      component: SinglePost,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 105,\n        columnNumber: 16\n      }\n    }) : /*#__PURE__*/React.createElement(Redirect, {\n      to: \"/auth\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 105,\n        columnNumber: 82\n      }\n    }), token ? /*#__PURE__*/React.createElement(Route, {\n      path: \"/profile\",\n      exact: true,\n      component: Profile,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 106,\n        columnNumber: 16\n      }\n    }) : /*#__PURE__*/React.createElement(Redirect, {\n      to: \"/auth\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 106,\n        columnNumber: 70\n      }\n    }), token ? /*#__PURE__*/React.createElement(Route, {\n      path: \"/profile/edit/:id\",\n      component: CreateProfile,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 16\n      }\n    }) : /*#__PURE__*/React.createElement(Redirect, {\n      to: \"/auth\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 79\n      }\n    }));\n  }\n\n  return /*#__PURE__*/React.createElement(AuthContext.Provider, {\n    value: {\n      isLoggedIn: !!token,\n      token: token,\n      userId: userId,\n      login: login,\n      logout: logout\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"App\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"main\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Router, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(MainNavigation, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(Switch, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Route, {\n    path: \"/post/:id\",\n    exact: true,\n    component: SinglePost,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 15\n    }\n  }), /*#__PURE__*/React.createElement(Route, {\n    path: \"/public/:id\",\n    component: Profile,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 15\n    }\n  }), /*#__PURE__*/React.createElement(Route, {\n    path: \"/auth\",\n    component: Auth,\n    exact: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 15\n    }\n  }), /*#__PURE__*/React.createElement(Route, {\n    path: \"/\",\n    component: Posts,\n    exact: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 15\n    }\n  }), route)), /*#__PURE__*/React.createElement(SocialMedia, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(Footer, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 11\n    }\n  })), loading));\n};\n\nexport default App;\n;","map":{"version":3,"sources":["/home/banish/Blogapp-using-MERN/src/App.js"],"names":["React","useState","useCallback","useEffect","Route","HashRouter","Router","Switch","Redirect","axios","Auth","MainNavigation","Posts","SinglePost","AuthContext","CreatePost","Profile","Mypost","CreateProfile","Spinner","Footer","SocialMedia","logoutTimer","App","props","token","setToken","tokenExpirationDate","setTokenExpirationDate","userId","setUserId","isLoading","setIsloading","login","uid","expirationDate","Date","getTime","localStorage","setItem","JSON","stringify","expiration","toISOString","defaults","headers","common","logout","removeItem","remainingTime","setTimeout","clearTimeout","storedData","parse","getItem","route","loading","isLoggedIn"],"mappings":"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","sourcesContent":["import React, { useState, useCallback, useEffect } from 'react';\n\nimport './App.css';\nimport {\n  Route,\n  HashRouter as Router,\n  Switch,\n  Redirect\n\n\n} from 'react-router-dom'\nimport axios from 'axios';\nimport Auth from './Components/Auth/Auth';\nimport MainNavigation from './Containers/Menubar/MainNavigation/MainNavigation';\nimport Posts from './Components/Posts/Posts';\nimport SinglePost from './Components/Posts/SinglePost/SinglePost';\nimport { AuthContext } from './context/auth-context'\nimport CreatePost from './Components/Posts/CreatePost/CreatePost';\nimport Profile from './Components/Users/Profile/Profile';\nimport Mypost from './Components/Posts/Mypost/Mypost';\nimport CreateProfile from './Components/Users/CreateProfile/CreateProfile'\n\nimport Spinner from './Containers/Spinner/Spinner';\nimport Footer from './Containers/footer/footer'\nimport SocialMedia from './Containers/SocialMedia.js/SocialMedia';\n\nlet logoutTimer;\n\nconst App = (props) => {\n\n\n  const [token, setToken] = useState(false);\n  const [tokenExpirationDate, setTokenExpirationDate] = useState();\n  const [userId, setUserId] = useState(false);\n  const [isLoading, setIsloading] = useState(true)\n\n  const login = useCallback((uid, token, expirationDate) => {\n    setToken(token);\n    setUserId(uid);\n    setIsloading(false)\n    const tokenExpirationDate =\n      expirationDate || new Date(new Date().getTime() + 1000 * 60 * 60);\n    setTokenExpirationDate(tokenExpirationDate);\n    localStorage.setItem(\n      'userData',\n      JSON.stringify({\n        userId: uid,\n        token: token,\n        expiration: tokenExpirationDate.toISOString()\n      })\n    );\n    axios.defaults.headers.common['Authorization'] = `Bearer ${token}`;\n\n  }, []);\n\n  const logout = useCallback(() => {\n    setToken(null);\n    setTokenExpirationDate(null);\n    setUserId(null);\n    localStorage.removeItem('userData');\n    localStorage.removeItem('profileData');\n    let token = null\n    axios.defaults.headers.common['Authorization'] = `Bearer ${token}`;\n\n  }, []);\n\n  useEffect(() => {\n    if (token && tokenExpirationDate) {\n      const remainingTime = tokenExpirationDate.getTime() - new Date().getTime();\n      logoutTimer = setTimeout(logout, remainingTime);\n    } else {\n      clearTimeout(logoutTimer);\n    }\n  }, [token, logout, tokenExpirationDate]);\n\n  useEffect(() => {\n    const storedData = JSON.parse(localStorage.getItem('userData'));\n    setIsloading(false)\n    if (\n      storedData &&\n      storedData.token &&\n      new Date(storedData.expiration) > new Date()\n    ) {\n      login(storedData.userId, storedData.token, new Date(storedData.expiration));\n    }\n  }, [login]);\n\n  let route\n  let loading\n  if (isLoading) {\n    loading = (<>\n      <div className=\"container loading\">\n        <div className=\"mar-20\">\n          <Spinner />\n        </div>\n      </div>\n    </>)\n  }\n  else {\n    route = (<>\n      {token ? <Route path=\"/create\" exact component={CreatePost}></Route> : <Redirect to=\"/auth\" />}\n      {token ? <Route path=\"/createProfile\" exact component={CreateProfile}></Route> : <Redirect to=\"/auth\" />}\n      {token ? <Route path=\"/edit/:id\" exact component={CreatePost}></Route> : <Redirect to=\"/auth\" />}\n      {token ? <Route path=\"/mypost\" exact component={Mypost}></Route> : <Redirect to=\"/auth\" />}\n      {token ? <Route path=\"/mypost/:id\" exact component={SinglePost}></Route> : <Redirect to=\"/auth\" />}\n      {token ? <Route path=\"/profile\" exact component={Profile} /> : <Redirect to=\"/auth\" />}\n      {token ? <Route path=\"/profile/edit/:id\" component={CreateProfile} /> : <Redirect to=\"/auth\" />}\n\n    </>\n    )\n  }\n  return (\n    <AuthContext.Provider\n      value={{\n        isLoggedIn: !!token,\n        token: token,\n        userId: userId,\n        login: login,\n        logout: logout\n      }}\n    >\n      <div className=\"App\">\n\n        <main>\n          <Router>\n            <MainNavigation />\n            <Switch>\n              <Route path=\"/post/:id\" exact component={SinglePost}></Route>\n              <Route path=\"/public/:id\" component={Profile} />\n              <Route path=\"/auth\" component={Auth} exact />\n              <Route path=\"/\" component={Posts} exact />\n              {route}\n\n            </Switch>\n          </Router>\n          <SocialMedia />\n          <Footer />\n        </main>\n        {loading}\n\n      </div>\n    </AuthContext.Provider>\n  );\n}\n\nexport default (App);;\n"]},"metadata":{},"sourceType":"module"}