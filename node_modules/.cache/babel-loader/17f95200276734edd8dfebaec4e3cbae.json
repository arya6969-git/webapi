{"ast":null,"code":"var _jsxFileName = \"/home/banish/Blogapp-using-MERN/src/Components/Posts/CreatePost/CreatePost.js\";\nimport Axios from 'axios';\nimport React, { Component } from 'react';\nimport ImageUpload from '../../../Containers/ImageUpload/ImageUpload';\nimport Spinner from '../../../Containers/Spinner/Spinner';\nexport class CreatePost extends Component {\n  constructor(props) {\n    super(props);\n\n    this.imageHandler = (id, value, isValid) => {\n      this.setState({\n        Post: { ...this.state.Post,\n          [id]: value\n        }\n      }, () => {});\n    };\n\n    this.myChangeHandler = event => {\n      var _event$target, _event$target2;\n\n      let nam = (_event$target = event.target) === null || _event$target === void 0 ? void 0 : _event$target.name;\n      let val = (_event$target2 = event.target) === null || _event$target2 === void 0 ? void 0 : _event$target2.value;\n      let errors = this.state.errors;\n      const {\n        name,\n        value\n      } = event.target;\n\n      switch (name) {\n        case 'title':\n          if (value.length > 0) {\n            errors.title = value.length < 6 ? 'Title   must be 5 characters long!' : '';\n          }\n\n          if (value.length === 0) {\n            errors.title = value.length === 0 ? 'title is required!' : '';\n          }\n\n          break;\n\n        case 'content':\n          if (value.length > 0) {\n            errors.content = value.length < 20 ? 'Content  must be 20 characters long!' : '';\n          }\n\n          if (value.length === 0) {\n            errors.content = value.length === 0 ? 'Content is required!' : '';\n          }\n\n          break;\n\n        case 'imagePath':\n          if (value.length === 0) {\n            errors.imagePath = value.length === 0 ? 'Image is required!' : '';\n          }\n\n          break;\n\n        default:\n          break;\n      }\n\n      this.setState({ ...errors,\n        Post: { ...this.state.Post,\n          [nam]: val\n        }\n      }, () => {});\n    };\n\n    this.state = {\n      Post: {\n        id: '',\n        title: '',\n        content: '',\n        imagePath: '',\n        created: ''\n      },\n      error: {\n        message: '',\n        code: ''\n      },\n      isloading: false,\n      haserror: false,\n      errors: {\n        title: '',\n        content: '',\n        imagePath: ''\n      }\n    };\n    this.mySubmitHandler = this.mySubmitHandler.bind(this);\n    this.myChangeHandler = this.myChangeHandler.bind(this);\n  }\n\n  componentDidMount() {\n    let path = this.props.match.path;\n    let id = this.props.match.params.id;\n    const storedData = JSON.parse(localStorage.getItem('profileData'));\n\n    if (!storedData && path == \"/create\") {\n      this.props.history.push(\"/createProfile\");\n    }\n\n    if (path === \"/edit/:id\") {\n      this.setState(pre => ({\n        isloading: true\n      }));\n      Axios.get(\"/posts/\" + id).then(data => {\n        let post = data.data;\n        this.setState({\n          isloading: false,\n          Post: { ...this.state.Post,\n            id: post._id,\n            title: post.title,\n            content: post.content,\n            imagePath: post.imagePath\n          }\n        });\n      }).catch(e => {\n        this.setState({\n          isloading: false,\n          error: { ...this.state.error,\n            message: e.response.data.message,\n            code: e.response.status\n          }\n        });\n      });\n    }\n\n    console.log(this.state);\n  }\n\n  mySubmitHandler(e) {\n    this.setState(pre => ({\n      isloading: true\n    }));\n    let path = this.props.match.path;\n    let id = this.props.match.params.id;\n    let date = new Date();\n    e.preventDefault();\n    let formData;\n\n    if (typeof this.state.Post.imagePath === \"object\") {\n      formData = new FormData();\n      formData.append('id', this.state.Post.id);\n      formData.append('title', this.state.Post.title);\n      formData.append('content', this.state.Post.content);\n      formData.append('image', this.state.Post.imagePath, this.state.Post.title);\n      formData.append('postDate', date.toString());\n    } else {\n      formData = {\n        \"id\": this.state.Post.id,\n        'title': this.state.Post.title,\n        'content': this.state.Post.content,\n        'image': this.state.Post.imagePath,\n        'postDate': date.toString()\n      };\n    }\n\n    if (path === \"/edit/:id\") {\n      Axios.put(\"/posts/\" + id, formData).then(data => {\n        this.setState(pre => ({\n          isloading: false\n        }));\n        this.props.history.push('/');\n      }).catch(e => {\n        this.setState({\n          isloading: false,\n          error: { ...this.state.error,\n            message: e.response.data.message,\n            code: e.response.status\n          }\n        });\n      });\n    } else {\n      Axios.post(\"/posts\", formData).then(data => {\n        this.setState(pre => ({\n          isloading: false\n        }));\n        this.props.history.push('/');\n      }).catch(e => {\n        this.setState({\n          isloading: false,\n          error: { ...this.state.error,\n            message: e.response.data.message,\n            code: e.response.status\n          }\n        });\n      });\n    }\n\n    this.setState({\n      Post: { ...this.state.Post,\n        title: '',\n        content: '',\n        imagePath: ''\n      }\n    });\n  }\n\n  render() {\n    let isLoading;\n    let iserror;\n\n    if (this.state.isloading) {\n      isLoading = /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"container loading\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 201,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"mar-20\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 202,\n          columnNumber: 25\n        }\n      }, /*#__PURE__*/React.createElement(Spinner, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 203,\n          columnNumber: 29\n        }\n      }))));\n    }\n\n    if (this.state.error.code) {\n      iserror = /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"container error container-short\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 212,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"mar-20\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 213,\n          columnNumber: 25\n        }\n      }, /*#__PURE__*/React.createElement(\"h5\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 214,\n          columnNumber: 29\n        }\n      }, \"Error Code - \", this.state.error.code), /*#__PURE__*/React.createElement(\"h4\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 215,\n          columnNumber: 29\n        }\n      }, \"Error Message - \", this.state.error.message))));\n    }\n\n    return /*#__PURE__*/React.createElement(React.Fragment, null, isLoading, iserror, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"container container-short\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 226,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"form\", {\n      onSubmit: this.mySubmitHandler,\n      className: \"pt-4\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 227,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"h3\", {\n      className: \"text-center mb-3\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 228,\n        columnNumber: 17\n      }\n    }, \"Create Post\"), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"form-group\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 229,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"label\", {\n      htmlFor: \"title\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 230,\n        columnNumber: 25\n      }\n    }, \"Title \"), /*#__PURE__*/React.createElement(\"input\", {\n      type: \"title\",\n      name: \"title\",\n      value: this.state.Post.title,\n      className: \"form-control \" + (this.state.errors.title ? 'is-invalid' : ''),\n      placeholder: \"Enter the title\",\n      required: true,\n      onChange: this.myChangeHandler,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 231,\n        columnNumber: 25\n      }\n    }), this.state.errors.title.length > 0 && /*#__PURE__*/React.createElement(\"div\", {\n      className: \"mt-1\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 242,\n        columnNumber: 29\n      }\n    }, /*#__PURE__*/React.createElement(\"span\", {\n      className: \"error text-danger\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 242,\n        columnNumber: 51\n      }\n    }, this.state.errors.title))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"form-group\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 246,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"label\", {\n      htmlFor: \"password\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 247,\n        columnNumber: 25\n      }\n    }, \"Description \"), /*#__PURE__*/React.createElement(\"textarea\", {\n      type: \"text\",\n      name: \"content\",\n      rows: \"4\",\n      value: this.state.Post.content,\n      className: \"form-control \" + (this.state.errors.content ? 'is-invalid' : ''),\n      placeholder: \"Enter the  description\",\n      required: \"required\",\n      onChange: this.myChangeHandler,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 248,\n        columnNumber: 25\n      }\n    }), this.state.errors.content.length > 0 && /*#__PURE__*/React.createElement(\"div\", {\n      className: \"mt-1\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 260,\n        columnNumber: 29\n      }\n    }, /*#__PURE__*/React.createElement(\"span\", {\n      className: \"error text-danger\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 260,\n        columnNumber: 51\n      }\n    }, this.state.errors.content))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"form-group\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 262,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"label\", {\n      htmlFor: \"password\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 263,\n        columnNumber: 25\n      }\n    }, \"Image \"), /*#__PURE__*/React.createElement(ImageUpload, {\n      id: \"imagePath\",\n      name: \"imagePath\",\n      onInput: this.imageHandler,\n      value: this.state.Post.imagePath,\n      errorText: \"Please provide an image.\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 264,\n        columnNumber: 25\n      }\n    }), this.state.errors.imagePath.length > 0 && /*#__PURE__*/React.createElement(\"div\", {\n      className: \"mt-1\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 272,\n        columnNumber: 29\n      }\n    }, /*#__PURE__*/React.createElement(\"span\", {\n      className: \"error text-danger\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 272,\n        columnNumber: 51\n      }\n    }, this.state.errors.imagePath))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"form-group\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 274,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      style: {\n        marginRight: '15px'\n      },\n      type: \"submit\",\n      className: \"btn btn-primary\",\n      disabled: this.state.Post.title && this.state.Post.content && this.state.Post.imagePath ? '' : 'disabled',\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 275,\n        columnNumber: 25\n      }\n    }, \"Submit\")))));\n  }\n\n}\nexport default CreatePost;","map":{"version":3,"sources":["/home/banish/Blogapp-using-MERN/src/Components/Posts/CreatePost/CreatePost.js"],"names":["Axios","React","Component","ImageUpload","Spinner","CreatePost","constructor","props","imageHandler","id","value","isValid","setState","Post","state","myChangeHandler","event","nam","target","name","val","errors","length","title","content","imagePath","created","error","message","code","isloading","haserror","mySubmitHandler","bind","componentDidMount","path","match","params","storedData","JSON","parse","localStorage","getItem","history","push","pre","get","then","data","post","_id","catch","e","response","status","console","log","date","Date","preventDefault","formData","FormData","append","toString","put","render","isLoading","iserror","marginRight"],"mappings":"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","sourcesContent":["import Axios from 'axios';\nimport React, { Component } from 'react'\nimport ImageUpload from '../../../Containers/ImageUpload/ImageUpload'\nimport Spinner from '../../../Containers/Spinner/Spinner';\nexport class CreatePost extends Component {\n    constructor(props) {\n        super(props)\n\n        this.state = {\n            Post: {\n                id: '',\n                title: '',\n                content: '',\n                imagePath: '',\n                created: ''\n            },\n            error: {\n                message: '',\n                code: ''\n            },\n            isloading: false,\n\n            haserror: false,\n            errors: {\n                title: '',\n                content: '',\n                imagePath: '',\n            }\n        }\n        this.mySubmitHandler = this.mySubmitHandler.bind(this);\n        this.myChangeHandler = this.myChangeHandler.bind(this);\n    }\n\n    componentDidMount() {\n\n        let path = this.props.match.path\n        let id = this.props.match.params.id\n        const storedData = JSON.parse(localStorage.getItem('profileData'));\n        if (!storedData && path == \"/create\") {\n                this.props.history.push(\"/createProfile\")\n        }\n        if (path === \"/edit/:id\") {\n            this.setState(pre => ({\n                isloading: true\n            }))\n\n            Axios.get(\"/posts/\" + id).then(data => {\n                let post = data.data\n                this.setState({\n                    isloading: false,\n                    Post: { ...this.state.Post, id: post._id, title: post.title, content: post.content, imagePath: post.imagePath }\n                });\n            })\n                .catch(e => {\n                    this.setState({\n                        isloading: false,\n                        error: {\n                            ...this.state.error, message: e.response.data.message,\n                            code: e.response.status\n                        }\n                    });\n                })\n        }\n        console.log(this.state)\n    }\n\n    imageHandler = (id, value, isValid) => {\n        this.setState({ Post: { ...this.state.Post, [id]: value } }, () => {\n\n        });\n\n    }\n\n    myChangeHandler = (event) => {\n        let nam = event.target?.name;\n        let val = event.target?.value;\n        let errors = this.state.errors;\n        const { name, value } = event.target;\n        switch (name) {\n\n            case 'title':\n                if (value.length > 0) {\n                    errors.title =\n                        value.length < 6\n                            ? 'Title   must be 5 characters long!'\n                            : '';\n                }\n\n                if (value.length === 0) {\n                    errors.title =\n                        value.length === 0\n                            ? 'title is required!'\n                            : '';\n                }\n                break;\n\n            case 'content':\n                if (value.length > 0) {\n                    errors.content =\n                        value.length < 20\n                            ? 'Content  must be 20 characters long!'\n                            : '';\n                }\n\n                if (value.length === 0) {\n                    errors.content =\n                        value.length === 0\n                            ? 'Content is required!'\n                            : '';\n                }\n                break;\n            case 'imagePath':\n                if (value.length === 0) {\n                    errors.imagePath =\n                        value.length === 0\n                            ? 'Image is required!'\n                            : '';\n                }\n                break;\n            default:\n                break;\n        }\n\n        this.setState({ ...errors, Post: { ...this.state.Post, [nam]: val } }, () => {\n\n        });\n    }\n\n    mySubmitHandler(e) {\n        this.setState(pre => ({\n            isloading: true\n        }))\n        let path = this.props.match.path\n        let id = this.props.match.params.id\n        let date = new Date()\n        e.preventDefault()\n        let formData;\n        if (typeof (this.state.Post.imagePath) === \"object\") {\n            formData = new FormData();\n            formData.append('id', this.state.Post.id);\n            formData.append('title', this.state.Post.title);\n            formData.append('content', this.state.Post.content);\n            formData.append('image', this.state.Post.imagePath, this.state.Post.title);\n            formData.append('postDate', date.toString());\n        }\n        else {\n            formData = {\n                \"id\": this.state.Post.id,\n                'title': this.state.Post.title,\n                'content': this.state.Post.content,\n                'image': this.state.Post.imagePath,\n                'postDate': date.toString()\n            }\n        }\n\n        if (path === \"/edit/:id\") {\n            Axios.put(\"/posts/\" + id, formData).then(data => {\n                this.setState(pre => ({\n                    isloading: false\n                }))\n                this.props.history.push('/')\n            })\n                .catch(e => {\n                    this.setState({\n                        isloading: false,\n                        error: {\n                            ...this.state.error, message: e.response.data.message,\n                            code: e.response.status\n                        }\n                    });\n                })\n        }\n        else {\n            Axios.post(\"/posts\", formData).then(data => {\n                this.setState(pre => ({\n                    isloading: false\n                }))\n                this.props.history.push('/')\n            })\n                .catch(e => {\n                    this.setState({\n                        isloading: false,\n                        error: {\n                            ...this.state.error, message: e.response.data.message,\n                            code: e.response.status\n                        }\n                    });\n                })\n        }\n        this.setState({\n            Post: { ...this.state.Post, title: '', content: '', imagePath: '' }\n        });\n    }\n    render() {\n        let isLoading\n        let iserror\n\n        if (this.state.isloading) {\n            isLoading = (\n                <>\n                    <div className=\"container loading\">\n                        <div className=\"mar-20\">\n                            <Spinner />\n                        </div>\n                    </div>\n                </>\n            )\n        }\n        if (this.state.error.code) {\n            iserror = (\n                <>\n                    <div className=\"container error container-short\">\n                        <div className=\"mar-20\">\n                            <h5>Error Code - {this.state.error.code}</h5>\n                            <h4>Error Message - {this.state.error.message}</h4>\n                        </div>\n                    </div>\n                </>\n            )\n        }\n\n        return (<>\n\n            {isLoading}\n            {iserror}\n            <div className=\"container container-short\">\n                <form onSubmit={this.mySubmitHandler} className=\"pt-4\">\n                <h3 className=\"text-center mb-3\">Create Post</h3>\n                    <div className=\"form-group\">\n                        <label htmlFor=\"title\">Title </label>\n                        <input\n                            type='title'\n                            name='title'\n                            value={this.state.Post.title}\n                            className={\"form-control \" + (this.state.errors.title ? 'is-invalid' : '')}\n                            placeholder=\"Enter the title\"\n                            required\n                            onChange={this.myChangeHandler}\n                        />\n\n                        {this.state.errors.title.length > 0 &&\n                            <div className=\"mt-1\"><span className='error text-danger'>{this.state.errors.title}</span></div>}\n\n                    </div>\n\n                    <div className=\"form-group\">\n                        <label htmlFor=\"password\">Description </label>\n                        <textarea\n                            type='text'\n                            name='content'\n                            rows=\"4\"\n                            value={this.state.Post.content}\n                            className={\"form-control \" + (this.state.errors.content ? 'is-invalid' : '')}\n                            placeholder=\"Enter the  description\"\n                            required=\"required\"\n                            onChange={this.myChangeHandler}\n                        />\n\n                        {this.state.errors.content.length > 0 &&\n                            <div className=\"mt-1\"><span className='error text-danger'>{this.state.errors.content}</span></div>}\n                    </div>\n                    <div className=\"form-group\">\n                        <label htmlFor=\"password\">Image </label>\n                        <ImageUpload\n                            id=\"imagePath\"\n                            name=\"imagePath\"\n                            onInput={this.imageHandler}\n                            value={this.state.Post.imagePath}\n                            errorText=\"Please provide an image.\"\n                        />\n                        {this.state.errors.imagePath.length > 0 &&\n                            <div className=\"mt-1\"><span className='error text-danger'>{this.state.errors.imagePath}</span></div>}\n                    </div>\n                    <div className=\"form-group\">\n                        <button style={{ marginRight: '15px' }}\n                            type='submit'\n                            className=\"btn btn-primary\"\n                            disabled={this.state.Post.title && this.state.Post.content && this.state.Post.imagePath\n                                ? '' : 'disabled'}\n                        >\n                            Submit\n                        </button>\n                    </div>\n                </form>\n            </div>\n        </>\n        )\n    }\n}\n\nexport default CreatePost\n"]},"metadata":{},"sourceType":"module"}